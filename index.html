<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>ğŸŒˆ å½©è™¹å“ˆå¸Œ Â· åå­—GayæŒ‡æ•°è®¡ç®—å™¨</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: linear-gradient(145deg, #f8f0fc 0%, #fff4e6 100%);
            font-family: 'Segoe UI', Roboto, system-ui, -apple-system, sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            margin: 0;
        }

        .rainbow-card {
            max-width: 650px;
            width: 100%;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 48px 48px 32px 32px;
            box-shadow: 0 25px 40px -15px rgba(0,0,0,0.15);
            padding: 30px 28px;
            border: 1px solid rgba(255,255,255,0.5);
            transition: all 0.2s ease;
        }

        /* å½©è™¹æ¡çº¹é¡¶è¾¹ */
        .rainbow-header {
            height: 10px;
            width: calc(100% + 56px);
            margin: -30px 0 20px -28px;
            border-radius: 48px 48px 0 0;
            background: linear-gradient(90deg, 
                #FF385C 0%, #FF9F1C 17%, 
                #FFD166 34%, #06D6A0 51%, 
                #1B98F5 68%, #9381FF 85%, 
                #E83F6F 100%);
            background-size: 200% 100%;
            animation: shimmer 8s infinite alternate;
        }

        @keyframes shimmer {
            0% { background-position: 0% 0; }
            100% { background-position: 100% 0; }
        }

        h1 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 2.1rem;
            font-weight: 700;
            letter-spacing: -0.5px;
            color: #2b2d42;
            margin-bottom: 5px;
        }

        h1 span {
            background: linear-gradient(45deg, #f72585, #b5179e);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-size: 2.3rem;
        }

        .sub {
            color: #5e548e;
            font-weight: 500;
            margin-bottom: 28px;
            padding-bottom: 10px;
            border-bottom: 2px dashed #cdb4db;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            font-size: 0.95rem;
        }

        .input-area {
            background: white;
            border-radius: 120px;
            padding: 6px 6px 6px 24px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            box-shadow: 0 8px 20px rgba(225, 180, 230, 0.2);
            border: 1px solid #ffc2d1;
            margin-bottom: 30px;
        }

        .input-area input {
            flex: 1 1 180px;
            border: none;
            padding: 16px 5px 16px 0;
            font-size: 1.2rem;
            font-weight: 500;
            color: #1e1e2f;
            background: transparent;
            outline: none;
            min-width: 140px;
        }

        .input-area input::placeholder {
            color: #b8b8d0;
            font-weight: 400;
            font-size: 1rem;
        }

        .rainbow-btn {
            background: linear-gradient(145deg, #ff4d6d, #ff0a54);
            border: none;
            color: white;
            padding: 14px 28px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid rgba(255,255,255,0.4);
            box-shadow: 0 5px 15px rgba(255, 72, 110, 0.4);
        }

        .rainbow-btn:hover {
            transform: scale(1.02);
            background: linear-gradient(145deg, #ff3355, #e5004a);
            box-shadow: 0 8px 22px rgba(255, 72, 110, 0.6);
        }

        .rainbow-btn:active {
            transform: scale(0.98);
        }

        .result-panel {
            background: rgba(253, 242, 250, 0.7);
            border-radius: 32px;
            padding: 28px 24px;
            margin-top: 10px;
            border: 1px solid rgba(255, 219, 229, 0.7);
            backdrop-filter: blur(10px);
        }

        .hash-badge {
            background: #1e1e2a;
            color: #f8f0fc;
            font-family: 'SF Mono', 'Fira Code', 'Courier New', monospace;
            padding: 12px 18px;
            border-radius: 18px;
            font-size: 0.9rem;
            word-break: break-all;
            border-left: 10px solid #ff9e00;
            margin-bottom: 25px;
            box-shadow: inset 0 0 0 1px #3e3e5e;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
        }

        .hash-value {
            letter-spacing: 2px;
            font-weight: 600;
            color: #ffe38f;
        }

        .gay-meter {
            margin: 24px 0 20px;
        }

        .meter-label {
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            color: #3a2e4a;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .progress-bg {
            background: #e9d7e3;
            height: 28px;
            border-radius: 30px;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid rgba(255,255,255,0.6);
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            border-radius: 30px;
            background: linear-gradient(90deg, #f94144, #f3722c, #f8961e, #f9c74f, #90be6d, #43aa8b, #577590);
            background-size: 200% 100%;
            transition: width 0.5s cubic-bezier(0.2, 0.9, 0.3, 1.1);
            box-shadow: 0 0 15px #ffb3c6;
            animation: rainbowMove 3s infinite alternate;
        }

        @keyframes rainbowMove {
            0% { background-position: 0% 0; }
            100% { background-position: 100% 0; }
        }

        .stats-grid {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 18px 0 12px;
            color: #2f1b3a;
            background: rgba(255, 235, 245, 0.8);
            padding: 16px 18px;
            border-radius: 28px;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
        }

        .stat-label {
            font-size: 0.8rem;
            text-transform: uppercase;
            color: #7a5b7a;
            letter-spacing: 2px;
        }

        .stat-number {
            font-size: 1.9rem;
            font-weight: 800;
            line-height: 1;
            color: #1e1e2a;
        }

        .badge-desc {
            background: white;
            padding: 14px 22px;
            border-radius: 60px;
            font-weight: 700;
            font-size: 1.3rem;
            display: inline-block;
            box-shadow: 0 3px 0 #ffb8d1;
            color: #2c1a4e;
            border: 1.5px solid #ffb3c1;
            margin-top: 8px;
            text-align: center;
            width: 100%;
        }

        .footnote {
            margin-top: 25px;
            color: #7b6d7c;
            font-size: 0.8rem;
            text-align: center;
            border-top: 1px dashed #e0b6c2;
            padding-top: 20px;
            font-style: italic;
        }

        .rainbow-factor {
            background: #fff0e7;
            border-radius: 50px;
            padding: 6px 18px;
            font-size: 0.9rem;
            font-weight: 600;
            color: #7f4f5a;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .example-tag {
            color: #a06b9a;
            background: rgba(234, 204, 255, 0.5);
            border-radius: 50px;
            padding: 5px 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid #ffa5a5;
        }

        .example-tag:hover {
            background: #ffd9df;
        }

        @media (max-width: 480px) {
            .rainbow-card { padding: 22px 18px; }
            h1 { font-size: 1.8rem; }
            .input-area { border-radius: 30px; padding-left: 18px; }
            .rainbow-btn { padding: 12px 20px; }
        }
    </style>
</head>
<body>
    <div class="rainbow-card">
        <div class="rainbow-header"></div>
        <h1>
            <span>ğŸŒˆ</span> å½©è™¹å“ˆå¸Œ
        </h1>
        <div class="sub">
            <span>åå­— Â· ç†µ Â· éª„å‚²æŒ‡æ•°</span>
            <span class="rainbow-factor">ğŸ³ï¸â€ğŸŒˆ çº¯å±å¨±ä¹</span>
        </div>

        <!-- è¾“å…¥åŒº -->
        <div class="input-area">
            <input type="text" id="nameInput" placeholder="è¾“å…¥ä»»ä½•åå­—, e.g. Taylor" value="Alex" autofocus>
            <button class="rainbow-btn" id="calcBtn">
                âœ¦ è®¡ç®—æŒ‡æ•°
            </button>
        </div>

        <!-- å¿«é€Ÿç¤ºä¾‹æ ‡ç­¾ï¼ˆç‚¹å‡»å¡«å……ï¼‰ -->
        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 10px;">
            <span class="example-tag" onclick="fillExample('Jordan')">Jordan</span>
            <span class="example-tag" onclick="fillExample('Riley')">Riley</span>
            <span class="example-tag" onclick="fillExample('Casey')">Casey</span>
            <span class="example-tag" onclick="fillExample('Skyler')">Skyler</span>
            <span class="example-tag" onclick="fillExample('Quinn')">Quinn</span>
        </div>

        <!-- ç»“æœé¢æ¿ï¼ŒåŠ¨æ€æ¸²æŸ“ -->
        <div class="result-panel" id="resultPanel">
            <!-- åˆå§‹çŠ¶æ€ä¼šé€šè¿‡JSå¡«å…… -->
        </div>

        <div class="footnote">
            âš¡ åŸºäºdjb2å“ˆå¸Œ + å½©è™¹å­—æ¯å› å­ Â· æ¯ä¸€ä¸ªåå­—éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ç†µå€¼è‰ºæœ¯<br>
            â¤ï¸ çˆ±æ— éœ€æŒ‡æ•°å®šä¹‰ï¼Œè¿™é‡Œåªæœ‰ç¬‘å£°å’Œå½©è™¹
        </div>
    </div>

    <script>
        // -----------------------------------------------------
        // çº¯å¨±ä¹ Â· åå­—GayæŒ‡æ•°è®¡ç®—å™¨ Â· å“ˆå¸Œæ ¸å¿ƒ
        // å“ˆå¸Œç®—æ³•: djb2 (32ä½) -> ç”Ÿæˆ8ä½åå…­è¿›åˆ¶å“ˆå¸Œ
        // å½©è™¹å› å­: åå­—ä¸­åŒ…å« r o y g b i v (ä¸åŒºåˆ†å¤§å°å†™) æ¯ä¸ª+2% (ä¸Šé™20%)
        // æœ€ç»ˆæŒ‡æ•° = (å“ˆå¸Œæ•´æ•° % 101) + å½©è™¹åŠ æˆ (ä¸è¶…è¿‡100)
        // -----------------------------------------------------

        // ----- å“ˆå¸Œå‡½æ•° (è¿”å›8ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²) -----
        function simpleHash(str) {
            let hash = 5381;       // djb2å¸¸ç”¨ç§å­
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) + hash) + char; // hash * 33 + char
                hash = hash & hash;                // ä¿æŒ32ä½
            }
            // è½¬æ¢ä¸ºæ— ç¬¦å·32ä½åå…­è¿›åˆ¶ï¼Œè¡¥è¶³8ä½
            return (hash >>> 0).toString(16).padStart(8, '0');
        }

        // ----- å½©è™¹å› å­è®¡ç®— -----
        function countRainbowLetters(name) {
            const rainbowSet = new Set(['r', 'o', 'y', 'g', 'b', 'i', 'v']);
            let count = 0;
            for (let ch of name.toLowerCase()) {
                if (rainbowSet.has(ch)) count++;
            }
            return count;
        }

        // ----- æ ¸å¿ƒæŒ‡æ•°è®¡ç®—å™¨ -----
        function calculateGayIndex(name) {
            if (!name || name.trim() === '') {
                return null;
            }

            const cleanName = name.trim().toLowerCase();
            
            // 1. å“ˆå¸Œå€¼è®¡ç®—
            const hashHex = simpleHash(cleanName);
            const hashInt = parseInt(hashHex, 16);      // 0 ~ 4294967295
            const baseIndex = hashInt % 101;            // 0-100 åŸºç¡€æŒ‡æ•°

            // 2. å½©è™¹å› å­ï¼šæ¯ä¸ªå½©è™¹å­—æ¯ +2%ï¼Œæœ€å¤š20%
            const rainbowCount = countRainbowLetters(cleanName);
            let rainbowBonus = Math.min(20, rainbowCount * 2);
            
            // 3. æœ€ç»ˆæŒ‡æ•° (ä¸Šé™100)
            let finalIndex = baseIndex + rainbowBonus;
            if (finalIndex > 100) finalIndex = 100;

            // 4. è¶£å‘³æè¿° (6æ¡£)
            let description = '';
            if (finalIndex <= 15) description = 'ğŸ’ ç›´å¦‚é’¢ç­‹';
            else if (finalIndex <= 30) description = 'â¡ï¸ éå¸¸ç›´çš„ç®­å¤´';
            else if (finalIndex <= 50) description = 'ğŸŒ€ å¶å°”ä¼šå¼¯ä¸€ä¸‹';
            else if (finalIndex <= 70) description = 'ğŸŒˆ çµæ´»å–å‘';
            else if (finalIndex <= 89) description = 'ğŸ“¡ å½©è™¹é›·è¾¾æ»´æ»´å“';
            else description = 'ğŸ³ï¸â€ğŸŒˆ è¡Œèµ°çš„å½©è™¹æ——';

            return {
                hash: hashHex,
                baseIndex: baseIndex,
                rainbowBonus: rainbowBonus,
                finalIndex: finalIndex,
                description: description,
                rainbowCount: rainbowCount,
                fullName: name.trim()
            };
        }

        // ----- æ¸²æŸ“UI -----
        function renderResult(result) {
            const panel = document.getElementById('resultPanel');
            if (!result) {
                panel.innerHTML = `<div style="padding: 20px; text-align: center; color: #a06a8a;">âœ¨ è¾“å…¥ä¸€ä¸ªåå­—ï¼Œçœ‹çœ‹å½©è™¹ç†µå€¼ï½</div>`;
                return;
            }

            const hashShort = result.hash; // 8ä½
            // æ„é€ æ˜¾ç¤ºç”¨çš„å®Œæ•´å“ˆå¸Œæ ‡ç­¾
            const hashDisplay = `${hashShort.substring(0, 4)} ${hashShort.substring(4, 8)}`;

            // è¿›åº¦æ¡å®½åº¦
            const progressWidth = result.finalIndex;

            // å½©è™¹å› å­æ–‡æœ¬
            const bonusText = result.rainbowBonus > 0 ? `+${result.rainbowBonus}% (${result.rainbowCount}ä¸ªğŸŒˆå­—æ¯)` : `+0% (æ— å½©è™¹å­—æ¯)`;

            const html = `
                <div class="hash-badge">
                    <span style="display: flex; gap: 6px; align-items: center;">ğŸ”‘ å“ˆå¸Œå€¼(djb2)</span>
                    <span class="hash-value" style="font-size: 1.2rem;">0x${hashDisplay}</span>
                </div>

                <div class="gay-meter">
                    <div class="meter-label">
                        <span>ğŸ³ï¸â€ğŸŒˆ GAYæŒ‡æ•°</span>
                        <span style="background: #1e1e2a; color: white; padding: 6px 16px; border-radius: 80px;">${result.finalIndex}%</span>
                    </div>
                    <div class="progress-bg">
                        <div class="progress-fill" style="width: ${progressWidth}%;"></div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">åŸºç¡€å“ˆå¸ŒæŒ‡æ•°</span>
                        <span class="stat-number">${result.baseIndex}%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ğŸŒˆ å½©è™¹åŠ æˆ</span>
                        <span class="stat-number" style="color: #d62878;">+${result.rainbowBonus}%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">å­—æ¯å«è™¹é‡</span>
                        <span class="stat-number">${result.rainbowCount}</span>
                    </div>
                </div>

                <div class="badge-desc">
                    ${result.description}
                </div>
                <p style="margin-top: 18px; font-size: 0.85rem; color: #5d5179; display: flex; justify-content: center; gap: 18px; flex-wrap: wrap;">
                    <span>âš¡ å“ˆå¸Œå–æ¨¡: ${result.baseIndex}</span>
                    <span>ğŸ¨ ${bonusText}</span>
                </p>
            `;
            panel.innerHTML = html;
        }

        // ----- è®¡ç®—ä¸»æµç¨‹ -----
        function computeAndRender() {
            const input = document.getElementById('nameInput');
            let name = input.value;
            if (!name || name.trim() === '') {
                renderResult(null);
                return;
            }
            const result = calculateGayIndex(name);
            renderResult(result);
        }

        // ----- å¡«å……ç¤ºä¾‹ (ç‚¹å‡»å¿«é€Ÿå¡«å…¥) -----
        window.fillExample = function(exampleName) {
            const input = document.getElementById('nameInput');
            input.value = exampleName;
            computeAndRender();
        };

        // ----- åˆå§‹åŒ–ç»‘å®šäº‹ä»¶å’Œé»˜è®¤å€¼-----
        window.onload = function() {
            const btn = document.getElementById('calcBtn');
            const input = document.getElementById('nameInput');
            
            // ç»‘å®šè®¡ç®—æŒ‰é’®
            btn.addEventListener('click', computeAndRender);
            
            // ç»‘å®šå›è½¦äº‹ä»¶
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    computeAndRender();
                }
            });

            // é»˜è®¤è®¡ç®— (Alex)
            computeAndRender();
        };

        // é™„åŠ ï¼šé˜²æŠ–ä¸éœ€è¦ï¼Œè½»é‡å¨±ä¹
    </script>

    <!-- ç¡®ä¿å³ä½¿è„šæœ¬åŠ è½½å»¶è¿Ÿï¼Œexample tagsä¹Ÿèƒ½å·¥ä½œï¼ˆå·²åœ¨windowä½œç”¨åŸŸï¼‰ -->
</body>
</html>
